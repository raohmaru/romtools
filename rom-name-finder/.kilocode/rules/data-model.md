# Migration Strategy

1. **Modify Schema**: Update `prisma/schema.prisma`
2. **Create Migration**: Run `npx prisma migrate dev --name migration_name`
3. **Review Migration**: Check generated SQL in `prisma/migrations/`
4. **Test Locally**: Verify migration works in development
5. **Deploy**: Run `npx prisma migrate deploy` in production

## Migration Best Practices

- Always backup database before migrations in production
- Test migrations on staging first
- Keep migrations small and focused
- Never edit existing migration files
- Use descriptive migration names
- Consider data migration scripts for complex changes

# When working with data:
- Always use Prisma Client, never raw SQL queries
- Validate input with Zod schemas before database operations
- Use TypeScript types generated by Prisma
- Include proper error handling for database operations
- Use transactions for operations that must succeed together
- Add indexes for frequently queried fields
- Consider cascade delete behavior when defining relationships
- Never expose Prisma models directly to API responses - use DTOs
- Always use parameterized queries (Prisma handles this automatically)

# When creating models:
- Define models in Prisma schema first
- Use Prisma-generated TypeScript types
- Create Zod schemas for validation
- Create DTOs for API responses
- Follow naming conventions (PascalCase for types, camelCase for fields)
- Include required fields (id, createdAt, updatedAt)
- Use proper TypeScript types, avoid `any`
- Handle null/undefined cases explicitly
- Convert dates to ISO strings for JSON serialization
- Document complex relationships
- Use type guards for runtime type checking